# Тестовое задание
### Задание:

Реализовать API сервис по работе с балансами.

### Пример:
Нужно реализовать:
- REST API добавление пользователя
- REST API добавление транзакции (DEPOSIT или WITHDRAW)
- REST API получить информацию о транзакции
- REST API получить текущий баланс пользователя (без селекта всех транзакций) или баланс за дату (например, запрос "сколько у Васи было денег 5.05.2022 00:00")

Ваша реализация должна проходить тесты `pytest՝.


### Дополнительно:

- учесть, что сервис будет запускаться в k8s.
- учесть, что архитектура должна гарантировать обработку транзакции ровно 1 раз. Какие требования это накладывает на сам сервис и соседние сервисы?
- описать (можно не реализовывать), как можно реализовать уведомление других сервисов о транзакциях. Например, уведомить рекламный движок, который работает при наличии средств на счету.
- тезисно перечислить, какие инструменты можно применить для контроля качества работы сервиса
- гарантировать, что баланс пользователя не может быть отрицательным 

# Инструкция

### Запуск сервера:
1. Склонировать репозиторий.
2. В корне репозитория запустить `docker-compose up --build main`. `docker-compose` запустить сборку контейнера с веб приложением и БД, все зависимости установятся автоматически.
3. Для создания базы данных под проект, можно воспользоваться скриптом `resetdb.sh`, скрипт удалит и создаст пользователя и БД.
4. Миграции в `alembic` формируются в скрипте `start.sh`, он же запускает сервер.
3. Ждем пока приложение не отпишется, что сервер запущен.
4. Ура! Наш сервер запущен, мы смело можем открыть `swagger` по адресу `http://0.0.0.0:8000/docs#/`

В `swagger` мы можем проверить работу `endpoint'ов` или можно из консоли, через `curl` запросы.
Для запуска тестов необходимо запустить сервис и в корне проекта запустить команду `pytest tests`.

### Ответы на вопросы:
> Как можно реализовать уведомление других сервисов о транзакциях 

При пополняющей транзакции мы оповещаем рекламный движок о наличии средств, если баланс клиента будет равен 0.00, то мы еще раз оповещаем рекламный движок.

> Тезисно перечислить, какие инструменты можно применить для контроля качества работы сервиса

Если я правильно понимаю вопрос, то в данном случае это (средства мониторинга, оповещения, логгирование, автотесты в том числе нагрузочные, инструменты для тестирования безопасности, инструменты для анализа логов...)

> Обработка транзакции ровно 1 раз накладывает на сервис и соседние соедующие органичения

Увеличению времени ответа. Это может быть связано с тем, что приложение должно ждать ответа от базы данных, блокировать поток выполнения или синхронизировать операции.
Ограничения на масштабирование. Дополнительные ресурсы и технологии могут потребоваться для поддержки дополнительных запросов и обеспечения гарантированной обработки транзакции.
Ограничения на распределенность. В распределенной среде может быть сложно обеспечить гарантированную обработку транзакции, особенно если различные компоненты приложения работают в разных сетевых окружениях.
Увеличение нагрузки на сервер. Думаю это будет вытекающим фактором.
